# Диодные часы
## Предыстория
Мы не ставили себе целью создать оригинальный по своему содержанию проект, основным критерием для нас был наш собственный интерес. Первыми похожий проект реализовала группа венских дизайнеров, и интерес заключался в том, чтобы создать максимально идентичные часы. Мы хотели узнать, насколько нам удастся разобраться в принципе работы и создать нечто похожее, потому что разработчики (дизайнеры) не выложили подробного описания, только видео с демонстрацией работы. Кажется не так сложно. 
## Задачи
В первую очередь нужно было понять, как должны быть устроены наши часы. Каждому диоду нужно было дать возможность хранить свое состояние, для этого используют регистры. Так как нам нужно 8 регистров (по 8 разрядов в каждом), эти регистры тоже нужно как-то адресовать. Для этого в схеме нужен дешифратор и два 8 разрядных сдвиговых регистра, соединённых каскадом. 
Следующая задача - обеспечить питание. На вход мы подавали 12 вольт, рабочее напряжение логических элементов 5 вольт, а диодов - 3 вольта. Для перехода с 12 вольт на 5 мы использовали стабилизатор SN74HC05N. Для питания диодов использовали принцип деления напряжения, подключив два диода последовательно.

Теоретические задачи решены. Практически нужно было научиться работать с модулем часов, аккуратно спаять все детали, раздобыть подходящий корпус и достаточное количество проводов, затем придумать, как все закрепить.
## Hardware
Итак, детали для проекта нам понадобились следующие:
* лента из 60 светодиодов
* кнопка
* модуль часов DS1307 (в корпусе dip8)
* стабилизатор КР142ЕН5А с двумя конденсаторами
* инвертор КР1533ЛН1 (x2)
* 8-разрядный регистр-защелка SN74HC573АN (х8)
* инвертор с открытым стоком SN74HC05N (х10)
* сдвиговый регистр 74HC595 (x2)
* дешифратор 3 на 8 КР1533ИД3
* пластиковый корпус

![Фото с деталями](https://github.com/tokelau/mobile_robots/blob/master/details.jpg)

## Software
Для разработки прошивки мы использовали Arduino IDE. Здесь нам нужно было выполнить две основные задачи: научиться получать время с модуля часов и кодировать его в маску, понятную регистру. Скорость передачи данных мы выставили 57600, так как модуль времени работает именно с такой скоростью.
Код для установки времени выглядит так (запускается один раз): 
```c++
#include <DS1307RTC.h>

tmElements_t te;

void setup() {
  Serial.begin(57600);
  te.Hour = 18;
  te.Minute = 50;
  te.Second = 0;
  te.Day = 20; 
  te.Month = 4; 
  te.Year = CalendarYrToTm(2016); 
  RTC.write(te);
}
```

Далее функция, которая подсвечивает светодиоды, в зависимости от полученно байта. RegNum - номер регистра, на который мы отправляем данные (от 1 до 8), LightMask - последовательность из 8-ми битов. Пины 5 и 11 выводятся на E0 и ST на схеме соответственно. На 8 пин приходит информация с модуля часов, на 13 мы ее записываем.
```c++
void lightByMask(int RegNum, char LightMask)
{
  Serial.write(LightMask);
  digitalWrite(5, LOW);
  digitalWrite(11, LOW);
  shiftOut(8, 13, MSBFIRST, LightMask);
  shiftOut(8, 13, LSBFIRST, RegNum);
  digitalWrite(11, HIGH);
  digitalWrite(5, HIGH);
}
```
## Схема
![Здесь должна быть схема](https://github.com/tokelau/mobile_robots/blob/master/scheme.png)
## Трудности

